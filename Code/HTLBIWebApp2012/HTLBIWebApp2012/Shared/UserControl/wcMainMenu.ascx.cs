using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using HTLBIWebApp2012.Codes.BLL;
using CECOM;

namespace HTLBIWebApp2012.Shared.UserControl
{
    public partial class wcMainMenu : System.Web.UI.UserControl
    {
        public string CurTabID { get { return string.Format("li_{0}", GlobalVar.CurMainMnuCode); } }
        public string ImagesFolder
        {
            get
            {
                return Helpers.CombinePath(String.Format("{0}{1}",Request.Url.Authority, Request.ApplicationPath), "/Content/Images");
            }
        }
        public string WriteMenuToHTML()
        {
            // Cần lấy theo UserMenu của user hiện hành...
            var lstMnuObj = MySys.Me.Get_Menu().Where(p => p.ParentCode == null || p.ParentCode == "").ToArray();
            var ret = "";
            string appPath = Request.ApplicationPath == "/" ? "" : Request.ApplicationPath;
            foreach (var item in lstMnuObj)
            {
                var li_idname = string.Format("li_{0}", item.Code);
                var a_id = string.Format("a_{0}", item.Code);
                var a_href = string.Format("{2}/App/{0}/{0}.aspx?mmnucode={1}", item.Url, item.Code, appPath);
                ret +=
                "<li name=\"" + li_idname + "\" id=\"" + li_idname + "\">" +
                    "<a id=\"" + a_id + "\" href=\"" + a_href + "\">" +
                        "<span>" + item.NameEN + "</span>" +
                    "</a>" +
                "</li>\r\n";
            }
            return "<ul>\r\n" + ret + "</ul>";
        }
    }
}